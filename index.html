<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Integral Calculator</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="style.css" />
    <!-- Load Math.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/9.5.0/math.min.js"></script>
    <!-- Load mathjs-expression-parser -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs-expression-parser/3.1.0/mathjs-expression-parser.min.js"></script>
    <!-- Load Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
  </head>

  <body>
    <h1>LaTeX Preview</h1>
    <!-- Input field for LaTeX expression -->
    <textarea
      id="input-latex"
      placeholder="Enter LaTeX expression here"
      oninput="renderLatex()"
    ></textarea>
    <button onclick="calculateIntegral()">Calculate</button>
    <!-- Output preview of LaTeX expression -->
    <div class=".d-none" id="output-latex"></div>
    <div id="integral-expression"></div>

    <canvas id="graphCanvas" width="400" height="400"></canvas>
    <script>
      function calculateIntegral() {
        console.log("Button Pressed!");
        var integrate = document.getElementById("input-latex").value;

        const integralFunction = math.integral(integrate, "x").toString();

        document.getElementById(
          "integral-expression"
        ).innerHTML = `$$\\int ${integralFunction}\\, dx$$`;
      }
      function renderLatex() {
        // Get the LaTeX expression from the input field
        var latexInput = document.getElementById("input-latex").value;

        // Replace '^' with '**' for exponentiation
        var expression = latexInput.replace(/\^/g, "^");

        // Construct the LaTeX expression with the integral symbol and appropriate delimiters
        var outputElement = document.getElementById("output-latex");
        outputElement.innerHTML =
          "\\(" + "\\int " + expression + "\\, dx" + "\\)";
        MathJax.typeset();
      }
      // Function to draw the graph
      // Get the canvas element
      var canvas = document.getElementById("graphCanvas");
      var context = canvas.getContext("2d");

      // Function to draw the graph
      function drawGraph() {
        // Clear the canvas
        context.clearRect(0, 0, canvas.width, canvas.height);

        // Draw grid lines
        context.strokeStyle = "#ccc";
        context.lineWidth = 0.5;

        // Draw horizontal grid lines
        for (var y = -10; y <= 10; y++) {
          var screenY = canvas.height / 2 - y * 20; // Adjust scale and offset
          context.beginPath();
          context.moveTo(0, screenY);
          context.lineTo(canvas.width, screenY);
          context.stroke();

          // Draw y-axis labels
          context.fillStyle = "black";
          context.textAlign = "right";
          context.fillText(y, canvas.width / 2 - 10, screenY + 4);
        }

        // Draw vertical grid lines
        for (var x = -10; x <= 10; x++) {
          var screenX = canvas.width / 2 + x * 20; // Adjust scale and offset
          context.beginPath();
          context.moveTo(screenX, 0);
          context.lineTo(screenX, canvas.height);
          context.stroke();

          // Draw x-axis labels
          context.fillStyle = "black";
          context.textAlign = "center";
          context.fillText(x, screenX, canvas.height / 2 + 14);
        }

        // Draw x-axis
        context.strokeStyle = "black";
        context.lineWidth = 1;
        context.beginPath();
        context.moveTo(0, canvas.height / 2);
        context.lineTo(canvas.width, canvas.height / 2);
        context.stroke();

        // Draw y-axis
        context.beginPath();
        context.moveTo(canvas.width / 2, 0);
        context.lineTo(canvas.width / 2, canvas.height);
        context.stroke();

        // Draw a sample function (e.g., y = x^2)
        context.strokeStyle = "blue";
        context.lineWidth = 2;
        context.beginPath();
        for (var x = -10; x <= 10; x += 0.1) {
          var y = x * x;
          var screenX = canvas.width / 2 + x * 20; // Adjust scale and offset
          var screenY = canvas.height / 2 - y * 20; // Adjust scale and offset
          if (x === -10) {
            context.moveTo(screenX, screenY);
          } else {
            context.lineTo(screenX, screenY);
          }
        }
        context.stroke();
      }

      // Call drawGraph function
      drawGraph();
    </script>

    <script src="" async defer></script>
  </body>
</html>
